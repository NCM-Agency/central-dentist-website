---
// CTASection.astro - Call-to-action section with multiple variants
import Button from '../ui/Button.astro';

export interface Props {
  variant?: 'primary' | 'secondary' | 'centered' | 'split';
  title: string;
  description?: string;
  primaryCTA?: {
    text: string;
    href: string;
  };
  secondaryCTA?: {
    text: string;
    href: string;
  };
  backgroundImage?: string;
  backgroundColor?: 'teal' | 'olive' | 'gray' | 'white';
  class?: string;
}

const { 
  variant = 'centered',
  title,
  description,
  primaryCTA,
  secondaryCTA,
  backgroundImage,
  backgroundColor = 'teal',
  class: className = ''
} = Astro.props;

// Background color classes
const bgClasses = {
  teal: '',  // Will use inline styles for gradient
  olive: '',  // Will use inline styles for gradient
  gray: '',  // Will use inline styles
  white: 'bg-white'
};

// Text color classes based on background
const textClasses = {
  teal: 'text-white',
  olive: 'text-white',
  gray: 'text-white',
  white: 'text-gray-dark'
};

const bgClass = bgClasses[backgroundColor];
const textClass = textClasses[backgroundColor];

// Inline styles for backgrounds
const bgStyles = {
  teal: 'background: linear-gradient(to bottom right, #0099ba, #006786);',
  olive: 'background: linear-gradient(to bottom right, #a6b443, #c7cd85);',
  gray: 'background-color: #2d3748;',
  white: ''
};

const bgStyle = bgStyles[backgroundColor];
---

<section 
  class={`section-padding relative overflow-hidden ${bgClass} ${className}`}
  style={bgStyle}
  data-gjs-type="cta-section"
>
  
  <!-- Background Image -->
  {backgroundImage && (
    <div class="absolute inset-0 z-0">
      <img 
        src={backgroundImage}
        alt=""
        class="w-full h-full object-cover"
        loading="lazy"
      />
      <div class="absolute inset-0 bg-black/50"></div>
    </div>
  )}

  <!-- Content -->
  <div class="relative z-10 container mx-auto container-padding">
    
    {variant === 'centered' && (
      <div class="text-center max-w-4xl mx-auto">
        <h2 class={`text-section-header ${textClass} mb-6`}>
          <span data-gjs-editable="true">{title}</span>
        </h2>
        
        {description && (
          <p class={`font-body text-lg md:text-xl ${backgroundColor === 'white' ? 'text-gray-medium' : 'text-white/90'} mb-8 leading-relaxed`}>
            <span data-gjs-editable="true">{description}</span>
          </p>
        )}
        
        <div class="flex flex-col sm:flex-row gap-4 justify-center items-center">
          {primaryCTA && (
            <Button 
              variant={backgroundColor === 'white' ? 'primary' : 'accent'} 
              size="lg" 
              href={primaryCTA.href}
              class="min-w-[200px]"
            >
              {primaryCTA.text}
            </Button>
          )}
          
          {secondaryCTA && (
            <Button 
              variant="secondary" 
              size="lg" 
              href={secondaryCTA.href}
              class={`min-w-[200px] ${backgroundColor !== 'white' ? 'bg-white/10 backdrop-blur-sm border-white/20 text-white hover:bg-white hover:text-teal-dark' : ''}`}
            >
              {secondaryCTA.text}
            </Button>
          )}
        </div>
      </div>
    )}

    {variant === 'split' && (
      <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 lg:gap-12 items-center">
        <div>
          <h2 class={`text-section-header ${textClass} mb-6`}>
            <span data-gjs-editable="true">{title}</span>
          </h2>
          
          {description && (
            <p class={`font-body text-lg ${backgroundColor === 'white' ? 'text-gray-medium' : 'text-white/90'} mb-8 leading-relaxed`}>
              <span data-gjs-editable="true">{description}</span>
            </p>
          )}
        </div>
        
        <div class="flex flex-col gap-4">
          {primaryCTA && (
            <Button 
              variant={backgroundColor === 'white' ? 'primary' : 'accent'} 
              size="lg" 
              href={primaryCTA.href}
              fullWidth
            >
              {primaryCTA.text}
            </Button>
          )}
          
          {secondaryCTA && (
            <Button 
              variant="secondary" 
              size="lg" 
              href={secondaryCTA.href}
              fullWidth
              class={backgroundColor !== 'white' ? 'bg-white/10 backdrop-blur-sm border-white/20 text-white hover:bg-white hover:text-teal-dark' : ''}
            >
              {secondaryCTA.text}
            </Button>
          )}
        </div>
      </div>
    )}

    {variant === 'primary' && (
      <div class="max-w-3xl mx-auto text-center">
        <h2 class={`font-heading text-h2 md:text-h1 font-semibold ${textClass} mb-4`}>
          <span data-gjs-editable="true">{title}</span>
        </h2>
        
        {description && (
          <p class={`font-body text-base md:text-lg ${backgroundColor === 'white' ? 'text-gray-medium' : 'text-white/90'} mb-6 leading-relaxed`}>
            <span data-gjs-editable="true">{description}</span>
          </p>
        )}
        
        {primaryCTA && (
          <Button 
            variant={backgroundColor === 'white' ? 'primary' : 'accent'} 
            size="md" 
            href={primaryCTA.href}
          >
            {primaryCTA.text}
          </Button>
        )}
      </div>
    )}

    {variant === 'secondary' && (
      <div class="flex flex-col md:flex-row items-center justify-between gap-6">
        <div class="flex-1">
          <h3 class={`font-heading text-h3 font-semibold ${textClass} mb-2`}>
            <span data-gjs-editable="true">{title}</span>
          </h3>
          {description && (
            <p class={`font-body ${backgroundColor === 'white' ? 'text-gray-medium' : 'text-white/90'} leading-relaxed`}>
              <span data-gjs-editable="true">{description}</span>
            </p>
          )}
        </div>
        
        <div class="flex gap-3">
          {primaryCTA && (
            <Button 
              variant={backgroundColor === 'white' ? 'primary' : 'accent'} 
              size="md" 
              href={primaryCTA.href}
            >
              {primaryCTA.text}
            </Button>
          )}
          
          {secondaryCTA && (
            <Button 
              variant="secondary" 
              size="md" 
              href={secondaryCTA.href}
              class={backgroundColor !== 'white' ? 'bg-white/10 backdrop-blur-sm border-white/20 text-white hover:bg-white hover:text-teal-dark' : ''}
            >
              {secondaryCTA.text}
            </Button>
          )}
        </div>
      </div>
    )}
  </div>

  <!-- Decorative Elements -->
  {backgroundColor !== 'white' && (
    <div class="absolute inset-0 opacity-10 pointer-events-none">
      <svg width="100%" height="100%" class="w-full h-full">
        <defs>
          <pattern id="cta-pattern" x="0" y="0" width="60" height="60" patternUnits="userSpaceOnUse">
            <circle cx="30" cy="30" r="1" fill="white" opacity="0.3"/>
            <circle cx="15" cy="45" r="0.5" fill="white" opacity="0.2"/>
            <circle cx="45" cy="15" r="0.5" fill="white" opacity="0.4"/>
          </pattern>
        </defs>
        <rect width="100%" height="100%" fill="url(#cta-pattern)"/>
      </svg>
    </div>
  )}
</section>